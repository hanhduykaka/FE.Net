function html_gen_new_kem_theo(n){var t="",r,i;return t+=' <tr class="font-size-13" name="tr-edit" data-id="'+n.ID+'">',t+='    <td name="stt_'+n.ID+'"><\/td>',t+="    <td>",t+='   <input name="ten_chung_tu_'+n.ID+'" class="width-100 syt-radius-3 min-h-30 paddingMin" min="0" value="'+n.TenChungTu+'" type="text" />',t+="   <\/td>",t+="    <td>",t+='   <input name="so_ban_chinh_'+n.ID+'" class="width-100 syt-radius-3 min-h-30 paddingMin" min="0" value="'+n.SLBanChinh+'" type="number" onfocus="onfocusNumber(event)" />',t+="   <\/td>",t+="    <td>",t+='   <input name="so_ban_sao_'+n.ID+'" class="width-100 syt-radius-3 min-h-30 paddingMin" min="0" value="'+n.SLBanSao+'" type="number" onfocus="onfocusNumber(event)" />',t+="   <\/td>",t+="    <td>",t+='   <input name="so_ban_photo_'+n.ID+'" class="width-100 syt-radius-3 min-h-30 paddingMin" min="0" value="'+n.SLPhoto+'" type="number" onfocus="onfocusNumber(event)" />',t+="   <\/td>",t+="    <td>",t+='   <input name="ghi_chu_'+n.ID+'" class="width-100 syt-radius-3 min-h-30 paddingMin" value="'+n.GhiChu+'" type="text" />',t+="   <\/td>",t+="    <td class='text-center'>",n.AttachFile?(r=n.AttachFile.split("/"),i=r[r.length-1],t+='<span type="button" class="hidden" id="upload_'+n.ID+'" data-id="'+n.ID+'" title="Đính kèm" onclick="fn_trigger_attract(this)"><img class="img " src="/images/btndownload_u23534.png"><\/span>',t+='<input type="file" name ="'+n.ID+'" onchange="previewTapDinhKem(event)" id="file_Dinh_kem_'+n.ID+'"class="hidden upload upload_tap_dinh_kem upload-destination" accept=".doc,.docx, .xls, .xlsx, .pdf, .jpg, .jpeg, .png, .tiff, .gif, .sig, .enc"/>',t+='<div class="col-md-12 div_lst_tap_dinh_kem_'+n.ID+'"><div class="parent_dinh_kem">',t+="<a href='"+n.AttachFile.replace("~","")+"' download>"+(i.length>20?i.substring(0,20)+"...":i)+"<\/a>",t+="<input type='hidden' name='file_dinh_kem_"+n.ID+"' value="+n.AttachFile+"/>",t+="<span data-id="+n.ID+' class="glyphicon glyphicon-remove btn_xoa_dinh_kem cursor-pointer ml-5 color-red" > <\/span>',t+="<\/div><\/div>"):(t+='<span type="button" id="upload_'+n.ID+'" data-id="'+n.ID+'" title="Đính kèm" onclick="fn_trigger_attract(this)"><img class="img " src="/images/btndownload_u23534.png"><\/span>',t+='<input type="file" name ="'+n.ID+'" onchange="previewTapDinhKem(event)" id="file_Dinh_kem_'+n.ID+'"class="hidden upload upload_tap_dinh_kem upload-destination" accept=".doc,.docx, .xls, .xlsx, .pdf, .jpg, .jpeg, .png, .tiff, .gif, .sig, .enc"/><div class="col-md-12 div_lst_tap_dinh_kem_'+n.ID+'"><\/div>',t+="   <\/td>"),t+='   <td class="text-center" title="Xóa">',t+='    <div class="show-inline cursor-pointer min-h-30 mt-mobile-5">',t+=' <span type="button" title="Hủy" onclick="fn_cancel_edit(this)" ',t+=' class="glyphicon glyphicon-remove syt-icon-cancel"><\/span>',t+="   <\/div>",t+="   <\/td>",t+"  <\/tr>"}function onfocusNumber(n){$(n.target).select()}function fn_cancel_edit(n){var t=$(n),i=t.closest("tr");i.remove();reset_stt_kem_theo()}function fn_trigger_attract(n){var t=$(n),i=t.attr("data-id");$('input[name="'+i+'"]').click()}function previewTapDinhKem(n){var t=n.target.name,i=n.target.files;i&&i.length>0&&($.each(i,function(n,i){var r;if(i){var u=i.name.split(".").pop().toLowerCase(),f=_fileTypesDinhKem.indexOf(u)>-1,e=window.Check50MB(i.size);f?e?(r=new FileReader,r.onload=function(){var n="",r;n+='<div class="parent_dinh_kem">';n+="<a>"+(i.name.length>20?i.name.substring(0,20)+"...":i.name)+"<\/a>";n+="<span data-id="+t+' class="glyphicon glyphicon-remove btn_xoa_dinh_kem cursor-pointer ml-5 color-red" > <\/span>';n+="<\/div>";$(".div_lst_tap_dinh_kem_"+t).append(n);r={lastMod:i.lastModified,lastModDate:i.lastModifiedDate,name:i.name,size:i.size,type:i.type,id:t}},r.readAsDataURL(i)):window.alert_info("Vui lòng chọn file dưới 50MB"):window.alert_info("File đính kèm có định dạng không hợp lệ")}}),$("#upload_"+t).addClass("hidden"))}function reset_stt_kem_theo(){var n=$(".div_ho_so_kem_theo table tbody").children("tr");$.each(n,(n,t)=>{var r=$(t).attr("data-id"),i=$(t).find('td[name="stt_'+r+'"]');i.empty();i.append(n+1)})}function getChungTuKemTheo(n){var t,i;n?(t=JSON.stringify({hoSoId:n}),window.AjaxDungChung("post","/DesktopModules/MVC/NghiepVu/MotCua/GetChungTuKemTheoByHoSoIDJsonResult",window.moduleId,window.tabId,$("input[name='__RequestVerificationToken']").val(),t,"application/json; charset=utf-8","json",!0).then(n=>{if(n){var t=$(".div_ho_so_kem_theo table tbody");t.html("");$.each(n,(n,t)=>{var i={ID:window.newGUIDFunc(),TenChungTu:t.TenChungTu?t.TenChungTu:"",SLBanChinh:t.SLBanChinh,SLBanSao:t.SLBanSao,SLPhoto:t.SLPhoto,GhiChu:t.GhiChu?t.GhiChu:"",HoSoID:t.HoSoID,AttachFile:t.AttachFile};$(".div_ho_so_kem_theo table tbody").append(html_gen_new_kem_theo(i));_arrHoSoDinhKem.push({ID:i.ID,AttachFile:i.AttachFile})});reset_stt_kem_theo()}})):(i=$(".div_ho_so_kem_theo table tbody"),i.html(""))}$(document).on("click",".a_them_moi_kem_theo_index",()=>{var n={ID:window.newGUIDFunc(),TenChungTu:"",SLBanChinh:0,SLBanSao:0,SLPhoto:0,GhiChu:"",HoSoID:$('input[name="hdfHoSoId"]').val(),AttachFile:""};$(".div_ho_so_kem_theo table tbody").append(html_gen_new_kem_theo(n));reset_stt_kem_theo()});$(document).on("click",".parent_dinh_kem .btn_xoa_dinh_kem",n=>{n.preventDefault();var t=new PNotify({title:"Cảnh báo",text:"Bạn có chắc chắn xóa file đính kèm này không?",icon:"glyphicon glyphicon-question-sign",hide:!1,confirm:{confirm:!0},buttons:{closer:!1,sticker:!1},history:{history:!1},addclass:"stack-modal",stack:{dir1:"down",dir2:"right",modal:!0}}).get().on("pnotify.confirm",function(){var i=$(n.target),t=i.attr("data-id"),r=i.closest(".parent_dinh_kem");r.remove();$('input[name="'+t+'"]').attr("value","");$("#upload_"+t).removeClass("hidden");_arrHoSoDinhKem=_arrHoSoDinhKem.filter(n=>n.ID!=t)}).on("pnotify.cancel",function(){return"false"})});